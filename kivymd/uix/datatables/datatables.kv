#:import DEVICE_TYPE kivymd.material_resources.DEVICE_TYPE


<CellRow>
    orientation: "vertical"
    canvas:
        Color:
            rgba:
                ( \
                self.theme_cls.surfaceContainerHighestColor \
                if not root.background_color_selected_cell \
                else root.background_color_selected_cell \
                ) \
                if self.selected \
                else \
                ( \
                self.theme_cls.surfaceContainerLowColor \
                if not root.background_color_cell \
                else root.background_color_cell \
                )
        Rectangle:
            size: self.size
            pos: self.pos

    on_press: if DEVICE_TYPE != "desktop": root.table.on_mouse_select(self)
    on_enter: if DEVICE_TYPE == "desktop": root.table.on_mouse_select(self)

    BoxLayout:
        id: box
        padding: "8dp", "8dp", 0, "8dp"
        spacing: "16dp"

        MDCheckbox:
            id: check
            size_hint: None, None
            size: 0, 0
            opacity: 0

        BoxLayout:
            id: inner_box

            MDIcon:
                id: icon
                size_hint: None, None
                pos_hint: {"center_y": .5}
                size: ("24dp", "24dp") if root.icon else (0, 0)
                icon: root.icon if root.icon else ""
                theme_icon_color: "Custom"
                icon_color:
                    root.icon_color if root.icon_color else \
                    self.theme_cls.primaryColor

            MDLabel:
                id: label
                text: root.text
                markup: True
                theme_line_height: "Custom"
                line_height: 1
                halign: "left"
                padding_x: "8dp"

    MDDivider:


<CellHeader>
    orientation: "vertical"
    size_hint_y: None
    height: self.minimum_height
    spacing: "4dp"
    tooltip_text: root.tooltip if root.tooltip else root.text
    on_touch_down: if self.collide_point(*args[1].pos): print(lbl.text, root.tooltip)

    BoxLayout:
        id: box
        size_hint_y: None
        height: lbl.height

        MDLabel:
            id: lbl
            text: " " + root.text
            adaptive_height: True
            bold: True
            markup: True

    MDDivider:
        id: separator


<CellHeaderTooltipPlain>

    MDTooltipPlain:
        text: "3333333333"#root.tooltip_text


<SortButton>
    id: sort_btn
    icon: "arrow-up"
    pos_hint: {"center_y": 0.5}
    size: [dp(24), dp(0)]
    theme_text_color: "Custom"
    text_color: "yellow"  # self.theme_cls.secondary_text_color
    opacity: 0


<TableHeader>
    bar_width: 0
    do_scroll: False
    size_hint: 1, None
    height: header.height

    GridLayout:
        id: header
        rows: 1
        cols_minimum: root.cols_minimum
        size_hint: None, None
        size: self.minimum_size
        padding: 0, "8dp", 0, 0
        canvas:
            Color:
                rgba:
                    app.theme_cls.surfaceContainerLowColor \
                    if not root.background_color_header \
                    else root.background_color_header
            Rectangle:
                size: self.size
                pos: self.pos

        BoxLayout:
            orientation: "vertical"
#            size_hint_y: None
#            height: self.minimum_height

            BoxLayout:
                id: box
                padding: "12dp", "8dp", "4dp", 0
                spacing: "16dp"
#                size_hint_y: None
#                height: self.minimum_height

                BoxLayout:
                    size_hint: None, None
                    size: self.minimum_size
                    padding: 0, 0, 0, "4dp"

                    MDCheckbox:
                        id: check
    #                    size_hint: None, None
                        pos_hint: {'center_y': .5}
    #                    size: 0, 0
    #                    opacity: 0
                        on_release: root.table_data.select_all(self.state)

                CellHeaderTooltip:
                    id: first_cell
#                    size_hint_y: None
#                    height: self.minimum_height

            MDDivider:


<TableData>
    data: root.recycle_data
    data_first_cells: root.data_first_cells
    key_viewclass: "viewclass"

    TableRecycleGridLayout:
        id: row_controller
        key_selection: "selectable"
        cols: root.total_col_headings
        cols_minimum: root.cols_minimum
        default_size: None, dp(52)
        default_size_hint: 1, None
        size_hint: None, None
        height: self.minimum_height
        width: self.minimum_width
        multiselect: True
        touch_multiselect: True


<TablePagination>
    size_hint_y: None
    height: self.minimum_height
    spacing: "8dp"

    MDLabel:
        text: "Rows per page"
        shorten: True
        halign: "right"
        role: "small"
        padding: 0, 0, 0, "8dp"

    MDDropDownItem:
        id: drop_item
        pos_hint: {'center_y': .5}
        on_release: root.table_data.open_pagination_menu()

        MDDropDownItemText:
            text:
                "{}".format( \
                root.table_data.rows_num \
                if root.table_data.rows_num < len(root.table_data.row_data) \
                else \
                len(root.table_data.row_data) \
                )

    Widget:
        size_hint_x: None
        width: "32dp" if DEVICE_TYPE != "mobile" else "8dp"

    MDLabel:
        id: label_rows_per_page
        adaptive_size: True
        -text_size: None, None
        pos_hint: {"center_y": .5}
        role: "small"
        text:
            "1-{} of {}".format( \
            root.table_data.rows_num \
            if root.table_data.rows_num > len(root.table_data.row_data) else \
            len(root.table_data.row_data), len(root.table_data.row_data) \
            )

    MDIconButton:
        id: button_back
        icon: "chevron-left"
        user_font_size: "20sp" if DEVICE_TYPE != "mobile" else "16dp"
        ripple_scale: .5 if DEVICE_TYPE == "mobile" else 1
        pos_hint: {'center_y': .5}
        disabled: True
        md_bg_color_disabled: 0, 0, 0, 0
        on_release: root.table_data.set_next_row_data_parts("back")

    MDIconButton:
        id: button_forward
        icon: "chevron-right"
        user_font_size: "20sp" if DEVICE_TYPE != "mobile" else "16dp"
        ripple_scale: .5 if DEVICE_TYPE == "mobile" else 1
        pos_hint: {'center_y': .5}
        disabled: True
        md_bg_color_disabled: 0, 0, 0, 0
        on_release: root.table_data.set_next_row_data_parts("forward")


<MDDataTable>
    elevation: self.elevation_levels[self.elevation_level]
    shadow_radius: self.radius
    shadow_color:
        ( \
        self.theme_cls.shadowColor \
        if self.theme_shadow_color == "Primary" else \
        self.shadow_color \
        ) \
        if self.elevation_level else \
        self.theme_cls.transparentColor
    shadow_offset:
        [0, 0] \
        if self.theme_shadow_offset == "Primary" else \
        self.shadow_offset
    elevation_level:
        0 \
        if self.theme_elevation_level == "Primary" else \
        self.elevation_level

    canvas:
        Color:
            rgba:
                self.theme_cls.surfaceContainerLowColor \
                if not self.background_color else \
                self.background_color
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: self.radius

    BoxLayout:
        id: container
        orientation: "vertical"
        padding: "24dp", "24dp", "8dp", "8dp"
